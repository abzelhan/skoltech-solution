# Решение тестового задания для Skoltech
Проект представляет из себя сервис сохранения метрик с датчиков, и выдачи этих метрик через REST API.  

Используемые технологии:
1. Java 8
2. Spring Boot (Data)
3. Docker (docker-compose)
4. Gradle
5. JUnit
6. MapStruct
7. TestContainers
8. Lombok
9. Liquibase
10. Postgresql

## Запуск приложения
Первым делом нужно запустить контейнер с `Postgresql `. Для этого нужно перейти в папку `src/main/docker` и выполнить команду `docker-compose up -d`.
После этого на порту `5434` запуститься контейнер с базой данных `Postgresql 10.4` с пользователем `postgres` и паролем `root` и базой данных `skoltech`.

Далее нужно перейти в основной каталог и выполнить команду `gradlew bootJar`, после этого перейти в сгенерированную папку `build/libs`, там будет сгенерированый jar файл `skoltech-0.0.1-SNAPSHOT`.

Для запуска сервиса выполнить команду `java -jar skoltech-0.0.1-SNAPSHOT`. Сервис запуститься на порте `8080`.

Скрипт миграции базы данных запуститься автоматически во время запуска приложения. 

## Запуск тестов
Для запуска интеграционных тестов нужно перейти в основной каталог и выполнить команду `gradlew test`. Проект использует [TestContainters](https://www.testcontainers.org/) фреймворк для запуска контейнера с базой данных `PostgreSQL` для интеграционных тестов.
Жизненный цикл контейнера управляется фреймворком, и будет удален по окончанию тестов.

## API
1. `/api/save` - Сохранить список метрик.
2. `/api/history` - Выгрузить все измерения заданного датчика за заданный интервал времени.
3. `/api/latest` - Выгрузить текущие (последние на данных момент) значения всех датчиков для заданного объекта.
4. `/api/avg` - Выгрузить среднее из текущих значений датчиков для каждого объекта.
